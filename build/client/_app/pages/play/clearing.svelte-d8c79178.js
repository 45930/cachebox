import{S as x,i as z,s as A,e as b,w as I,k as M,c as y,a as S,x as K,m as L,d as _,b as v,g as P,y as V,G as f,q as D,o as G,B as j,Q as N,v as F,R as H,T as X,t as W,h as J,L as Q,K as Y}from"../../chunks/vendor-fc529e69.js";import{L as q,T as Z,l as ee}from"../../chunks/_tileMovements-e858f124.js";import{T as te}from"../../chunks/_tilePrompt-4ab1ae08.js";import{a as ne,g as O}from"../../chunks/navigation-c0b2019f.js";import{l as ae,d as se,C as re}from"../../chunks/minaStore-39014cbe.js";import oe from"./canvas/index.svelte-e4f9510c.js";import{s as U}from"../../chunks/stores-0e9b45d8.js";import"../../chunks/singletons-a6a7384f.js";import"../../chunks/preload-helper-e4860ae8.js";function ie(l){let e,a;return{c(){e=b("p"),a=W("Waiting for snarky...")},l(s){e=y(s,"P",{});var t=S(e);a=J(t,"Waiting for snarky..."),t.forEach(_)},m(s,t){P(s,e,t),f(e,a)},p:Q,d(s){s&&_(e)}}}function le(l){let e,a,s,t;return{c(){e=b("button"),a=W("Inspect Keypad")},l(r){e=y(r,"BUTTON",{});var o=S(e);a=J(o,"Inspect Keypad"),o.forEach(_)},m(r,o){P(r,e,o),f(e,a),s||(t=Y(e,"click",l[4]),s=!0)},p:Q,d(r){r&&_(e),s=!1,t()}}}function me(l){let e,a,s,t,r,o,$,u,k,h,g,w,i,c,C;a=new oe({props:{tileConfig:l[0]}}),o=new te({props:{prompt:l[0].prompt}}),u=new q({});function R(n,p){return n[1]?le:ie}let B=R(l),d=B(l);return g=new q({}),c=new Z({props:{movements:l[0].movements}}),{c(){e=b("div"),I(a.$$.fragment),s=M(),t=b("div"),r=b("div"),I(o.$$.fragment),$=M(),I(u.$$.fragment),k=M(),d.c(),h=M(),I(g.$$.fragment),w=M(),i=b("div"),I(c.$$.fragment),this.h()},l(n){e=y(n,"DIV",{class:!0});var p=S(e);K(a.$$.fragment,p),s=L(p),t=y(p,"DIV",{class:!0});var m=S(t);r=y(m,"DIV",{id:!0,class:!0});var T=S(r);K(o.$$.fragment,T),T.forEach(_),$=L(m),K(u.$$.fragment,m),k=L(m),d.l(m),h=L(m),K(g.$$.fragment,m),w=L(m),i=y(m,"DIV",{id:!0,class:!0});var E=S(i);K(c.$$.fragment,E),E.forEach(_),m.forEach(_),p.forEach(_),this.h()},h(){v(r,"id","tile-prompt"),v(r,"class","p-2 mb-12 rounded border-neutral-200 border-solid border-2 bg-white opacity-80"),v(i,"id","tile-movements"),v(i,"class","w-2xl mb-4 p-2 rounded border-neutral-200 border-solid border-2"),v(t,"class","relative bottom-36"),v(e,"class","container flex justify-center flex-wrap")},m(n,p){P(n,e,p),V(a,e,null),f(e,s),f(e,t),f(t,r),V(o,r,null),f(t,$),V(u,t,null),f(t,k),d.m(t,null),f(t,h),V(g,t,null),f(t,w),f(t,i),V(c,i,null),C=!0},p(n,[p]){const m={};p&1&&(m.tileConfig=n[0]),a.$set(m);const T={};p&1&&(T.prompt=n[0].prompt),o.$set(T),B===(B=R(n))&&d?d.p(n,p):(d.d(1),d=B(n),d&&(d.c(),d.m(t,h)));const E={};p&1&&(E.movements=n[0].movements),c.$set(E)},i(n){C||(D(a.$$.fragment,n),D(o.$$.fragment,n),D(u.$$.fragment,n),D(g.$$.fragment,n),D(c.$$.fragment,n),C=!0)},o(n){G(a.$$.fragment,n),G(o.$$.fragment,n),G(u.$$.fragment,n),G(g.$$.fragment,n),G(c.$$.fragment,n),C=!1},d(n){n&&_(e),j(a),j(o),j(u),d.d(),j(g),j(c)}}}function pe(l,e,a){let s,t,r,o,$;N(l,ee,i=>a(3,r=i)),N(l,se,i=>a(5,o=i)),N(l,U,i=>a(6,$=i)),F(async()=>{k()}),ne(async()=>{await u()});const u=async function(){const c=await(await fetch("/gameState",{headers:{"content-type":"application/json"},method:"PUT",body:JSON.stringify({hasVisitedClearing:!0})})).json();H(U,$=c,$)},k=function(){s||ae().then(()=>{a(1,s=!0)})},h=()=>{X(re,{onSubmit:g})},g=async i=>{await o.guessGateKey(i)=="winner"?O("/play/lab_hall"):O("/play/loser")},w=()=>h();return l.$$.update=()=>{l.$$.dirty&8&&a(0,t=r.clearing)},a(1,s=!1),[t,s,h,r,w]}class be extends x{constructor(e){super();z(this,e,pe,me,A,{})}}export{be as default};
