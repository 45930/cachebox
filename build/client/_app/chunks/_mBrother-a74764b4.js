import{S as ie,i as ce,s as ue,l as R,g as j,d as p,k as L,w as K,m as M,x as U,y as W,q as Q,o as P,B as X,e as b,t as q,c as k,a as y,h as H,b as v,X as fe,G as g,Y as F,K as J,n as _e,p as me,W as x,P as pe,Q as ee,u as he,R as de,Z as ve,j as $}from"./vendor-fc529e69.js";import{T as ge,l as be,I as ke,L as ye}from"./_tileMovements-bf43bc63.js";import Ee from"../pages/play/canvas/index.svelte-e4f9510c.js";import{a as we}from"./navigation-13fd7038.js";import{s as te}from"./stores-0e9b45d8.js";function oe(n,e,t){const l=n.slice();return l[13]=e[t],l}function le(n,e,t){const l=n.slice();return l[16]=e[t],l}function Ie(n){let e,t=(n[16].short||n[16].prompt)+"",l,s;return{c(){e=b("option"),l=q(t),this.h()},l(o){e=k(o,"OPTION",{});var a=y(e);l=H(a,t),a.forEach(p),this.h()},h(){e.__value=s=n[16].short||n[16].prompt,e.value=e.__value},m(o,a){j(o,e,a),g(e,l)},p(o,a){a&1&&t!==(t=(o[16].short||o[16].prompt)+"")&&$(l,t),a&1&&s!==(s=o[16].short||o[16].prompt)&&(e.__value=s,e.value=e.__value)},d(o){o&&p(e)}}}function Oe(n){let e,t=n[4][n[16].blockedOn]&&se(n);return{c(){t&&t.c(),e=R()},l(l){t&&t.l(l),e=R()},m(l,s){t&&t.m(l,s),j(l,e,s)},p(l,s){l[4][l[16].blockedOn]?t?t.p(l,s):(t=se(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&p(e)}}}function se(n){let e,t=(n[16].short||n[16].prompt)+"",l,s;return{c(){e=b("option"),l=q(t),this.h()},l(o){e=k(o,"OPTION",{class:!0});var a=y(e);l=H(a,t),a.forEach(p),this.h()},h(){v(e,"class","bg-orange-300 opacity-80"),e.__value=s=n[16].short||n[16].prompt,e.value=e.__value},m(o,a){j(o,e,a),g(e,l)},p(o,a){a&1&&t!==(t=(o[16].short||o[16].prompt)+"")&&$(l,t),a&1&&s!==(s=o[16].short||o[16].prompt)&&(e.__value=s,e.value=e.__value)},d(o){o&&p(e)}}}function ne(n){let e;function t(o,a){return o[16].blockedOn?Oe:Ie}let l=t(n),s=l(n);return{c(){s.c(),e=R()},l(o){s.l(o),e=R()},m(o,a){s.m(o,a),j(o,e,a)},p(o,a){l===(l=t(o))&&s?s.p(o,a):(s.d(1),s=l(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){s.d(o),o&&p(e)}}}function De(n){let e,t=n[13].text+"",l;return{c(){e=b("div"),l=q(t),this.h()},l(s){e=k(s,"DIV",{class:!0});var o=y(e);l=H(o,t),o.forEach(p),this.h()},h(){v(e,"class","float-right w-80 rounded bg-blue-400 p-1 my-1 mr-1")},m(s,o){j(s,e,o),g(e,l)},p(s,o){o&8&&t!==(t=s[13].text+"")&&$(l,t)},d(s){s&&p(e)}}}function Te(n){let e,t=n[13].text+"",l;return{c(){e=b("div"),l=q(t),this.h()},l(s){e=k(s,"DIV",{class:!0});var o=y(e);l=H(o,t),o.forEach(p),this.h()},h(){v(e,"class","float-left w-80 rounded bg-slate-400 p-1 my-1 ml-1")},m(s,o){j(s,e,o),g(e,l)},p(s,o){o&8&&t!==(t=s[13].text+"")&&$(l,t)},d(s){s&&p(e)}}}function ae(n){let e,t,l;function s(r,_){return r[13].from=="them"?Te:De}let o=s(n),a=o(n);return t=new ye({}),{c(){a.c(),e=L(),K(t.$$.fragment)},l(r){a.l(r),e=M(r),U(t.$$.fragment,r)},m(r,_){a.m(r,_),j(r,e,_),W(t,r,_),l=!0},p(r,_){o===(o=s(r))&&a?a.p(r,_):(a.d(1),a=o(r),a&&(a.c(),a.m(e.parentNode,e)))},i(r){l||(Q(t.$$.fragment,r),l=!0)},o(r){P(t.$$.fragment,r),l=!1},d(r){a.d(r),r&&p(e),X(t,r)}}}function Ve(n){let e,t,l,s,o,a,r,_,w,I,E,A,O,D,B,u,C;t=new Ee({props:{tileConfig:n[2]}});let T=Object.values(n[0]),d=[];for(let i=0;i<T.length;i+=1)d[i]=ne(le(n,T,i));let N=n[3],f=[];for(let i=0;i<N.length;i+=1)f[i]=ae(oe(n,N,i));const re=i=>P(f[i],1,1,()=>{f[i]=null});return D=new ge({props:{movements:n[5].movements}}),{c(){e=b("div"),K(t.$$.fragment),l=L(),s=b("div"),o=b("div"),a=b("div"),r=b("select"),_=b("option"),w=q("Ask a Question");for(let i=0;i<d.length;i+=1)d[i].c();I=L(),E=b("div");for(let i=0;i<f.length;i+=1)f[i].c();A=L(),O=b("div"),K(D.$$.fragment),this.h()},l(i){e=k(i,"DIV",{class:!0});var m=y(e);U(t.$$.fragment,m),l=M(m),s=k(m,"DIV",{class:!0});var h=y(s);o=k(h,"DIV",{id:!0,class:!0});var c=y(o);a=k(c,"DIV",{class:!0});var V=y(a);r=k(V,"SELECT",{name:!0,id:!0,class:!0});var G=y(r);_=k(G,"OPTION",{});var Y=y(_);w=H(Y,"Ask a Question"),Y.forEach(p);for(let S=0;S<d.length;S+=1)d[S].l(G);G.forEach(p),V.forEach(p),c.forEach(p),I=M(h),E=k(h,"DIV",{id:!0,class:!0});var Z=y(E);for(let S=0;S<f.length;S+=1)f[S].l(Z);Z.forEach(p),A=M(h),O=k(h,"DIV",{id:!0,class:!0});var z=y(O);U(D.$$.fragment,z),z.forEach(p),h.forEach(p),m.forEach(p),this.h()},h(){_.__value="Ask a Question",_.value=_.__value,_.selected=!0,_.disabled=!0,_.hidden=!0,v(r,"name","select"),v(r,"id","select"),v(r,"class","px-4 outline-none text-gray-800 w-full"),n[1]===void 0&&fe(()=>n[9].call(r)),v(a,"class","bg-slate-500 opacity-80"),v(o,"id","questions"),v(o,"class","flex justify-end mb-3"),v(E,"id","dialogue"),v(E,"class","w-lg h-80 mx-auto overflow-y-auto bg-white opacity-80 mb-12"),v(O,"id","tile-movements"),v(O,"class","w-2xl mb-4 p-2 rounded border-neutral-200 border-solid border-2"),v(s,"class","relative -top-96 mx-auto"),v(e,"class","container flex justify-center flex-wrap")},m(i,m){j(i,e,m),W(t,e,null),g(e,l),g(e,s),g(s,o),g(o,a),g(a,r),g(r,_),g(_,w);for(let h=0;h<d.length;h+=1)d[h].m(r,null);F(r,n[1]),g(s,I),g(s,E);for(let h=0;h<f.length;h+=1)f[h].m(E,null);g(s,A),g(s,O),W(D,O,null),B=!0,u||(C=[J(r,"change",n[9]),J(r,"change",n[10])],u=!0)},p(i,[m]){const h={};if(m&4&&(h.tileConfig=i[2]),t.$set(h),m&17){T=Object.values(i[0]);let c;for(c=0;c<T.length;c+=1){const V=le(i,T,c);d[c]?d[c].p(V,m):(d[c]=ne(V),d[c].c(),d[c].m(r,null))}for(;c<d.length;c+=1)d[c].d(1);d.length=T.length}if(m&3&&F(r,i[1]),m&8){N=i[3];let c;for(c=0;c<N.length;c+=1){const V=oe(i,N,c);f[c]?(f[c].p(V,m),Q(f[c],1)):(f[c]=ae(V),f[c].c(),Q(f[c],1),f[c].m(E,null))}for(_e(),c=N.length;c<f.length;c+=1)re(c);me()}},i(i){if(!B){Q(t.$$.fragment,i);for(let m=0;m<N.length;m+=1)Q(f[m]);Q(D.$$.fragment,i),B=!0}},o(i){P(t.$$.fragment,i),f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)P(f[m]);P(D.$$.fragment,i),B=!1},d(i){i&&p(e),X(t),x(d,i),x(f,i),X(D),u=!1,pe(C)}}}function je(n,e,t){let l,s,o,a;ee(n,be,u=>t(8,o=u)),ee(n,te,u=>t(4,a=u));let{name:r}=e;const _=o[r],w={};_.interactions.filter(u=>u.type==ke.Dialogue).forEach(u=>{t(0,w[u.short||u.prompt]=u,w)}),we(async()=>{await A()}),he(()=>{O()});let I="Ask a Question";const E=function(){console.log(w),console.log(I);const u=w[I];if(u){const C=u.prompt,T=u.response;t(3,l=[...l,{from:"us",text:C}]),t(3,l=[...l,{from:"them",text:T}])}t(1,I="Ask a Question")},A=async function(){const C=await(await fetch("/gameState",{headers:{"content-type":"application/json"},method:"GET"})).json();de(te,a=C,a)},O=function(){const u=document.getElementById("dialogue");console.log(u.scrollHeight),u.scrollTop=u.scrollHeight};function D(){I=ve(this),t(1,I),t(0,w)}const B=()=>E();return n.$$set=u=>{"name"in u&&t(7,r=u.name)},n.$$.update=()=>{n.$$.dirty&384&&t(2,s=o[r])},t(3,l=_.prompt.map(u=>({from:"them",text:u}))),[w,I,s,l,a,_,E,r,o,D,B]}class Ae extends ie{constructor(e){super();ce(this,e,je,Ve,ue,{name:7})}}export{Ae as M};
